[{"filePath":"C:\\Users\\tomoh\\clawd\\vibe-cooking\\api\\analyze-flyer.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tomoh\\clawd\\vibe-cooking\\api\\extract-recipe.ts","messages":[],"suppressedMessages":[{"ruleId":"@typescript-eslint/no-explicit-any","severity":2,"message":"Unexpected any. Specify a different type.","line":64,"column":63,"nodeType":"TSAnyKeyword","messageId":"unexpectedAny","endLine":64,"endColumn":66,"suggestions":[{"messageId":"suggestUnknown","fix":{"range":[2377,2380],"text":"unknown"},"desc":"Use `unknown` instead, this will force you to explicitly, and safely assert the type is correct."},{"messageId":"suggestNever","fix":{"range":[2377,2380],"text":"never"},"desc":"Use `never` instead, this is useful when instantiating generic type parameters that you don't need to know the type of."}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tomoh\\clawd\\vibe-cooking\\api\\fetch-title.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tomoh\\clawd\\vibe-cooking\\api\\patrol.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tomoh\\clawd\\vibe-cooking\\eslint.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tomoh\\clawd\\vibe-cooking\\postcss.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tomoh\\clawd\\vibe-cooking\\scripts\\check-api.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tomoh\\clawd\\vibe-cooking\\src\\App.tsx","messages":[{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from 'react-hooks/exhaustive-deps').","line":99,"column":5,"severity":1,"nodeType":null,"fix":{"range":[3816,3871],"text":" "}},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchWeeklyPlan'. Either include it or remove the dependency array.","line":105,"column":6,"nodeType":"ArrayExpression","endLine":105,"endColumn":17,"suggestions":[{"desc":"Update the dependencies array to be: [fetchWeeklyPlan, startDate]","fix":{"range":[3951,3962],"text":"[fetchWeeklyPlan, startDate]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":2,"fixableErrorCount":0,"fixableWarningCount":1,"source":"import { useEffect, useState } from 'react';\nimport { DndContext, DragOverlay, useSensor, useSensors, MouseSensor, TouchSensor, useDroppable } from '@dnd-kit/core';\nimport type { DragEndEvent, DragStartEvent } from '@dnd-kit/core';\nimport { addDays, isTuesday, previousTuesday, format } from 'date-fns';\nimport { supabase } from './lib/supabase';\nimport { RecipeForm } from './components/RecipeForm';\nimport { RecipeDetailModal } from './components/RecipeDetailModal';\nimport { WeeklyBoard } from './components/WeeklyBoard';\nimport { DraggableRecipe } from './components/DraggableRecipe';\nimport { PatrolView } from './components/PatrolView';\nimport { SoupGachaModal } from './components/SoupGachaModal';\nimport { FlyerAnalysisView } from './components/FlyerAnalysisView';\n\nimport type { Recipe, WeeklyPlanItem, DaySetting } from './types';\n\nconst SidebarDroppable = ({ children }: { children: React.ReactNode }) => {\n  const { setNodeRef } = useDroppable({ id: 'sidebar-bookshelf' });\n  return <div ref={setNodeRef} className=\"flex-1 flex flex-col h-full\">{children}</div>;\n};\n\nfunction App() {\n  const [recipes, setRecipes] = useState<Recipe[]>([]);\n  const [plans, setPlans] = useState<WeeklyPlanItem[]>([]);\n  const [daySettings, setDaySettings] = useState<DaySetting[]>([]);\n  const [loading, setLoading] = useState(true);\n  const [activeId, setActiveId] = useState<string | null>(null);\n  const [activeRecipe, setActiveRecipe] = useState<Recipe | null>(null);\n  const [activeTab, setActiveTab] = useState<'my_recipes' | 'coop' | 'buzz' | 'shopping'>('my_recipes');\n  const [editingRecipe, setEditingRecipe] = useState<Recipe | null>(null);\n\n  // Gacha State\n  const [gachaTargetDate, setGachaTargetDate] = useState<Date | null>(null);\n\n  // RecipeForm Control\n  const [isRecipeFormOpen, setIsRecipeFormOpen] = useState(false);\n  const [recipeFormInitialUrl, setRecipeFormInitialUrl] = useState('');\n  const [recipeFormInitialData, setRecipeFormInitialData] = useState<{\n    name?: string;\n    ingredients?: string[];\n    category?: 'main' | 'side' | 'soup';\n    memo?: string;\n  } | undefined>(undefined);\n\n  // Bookshelf Filter State\n  const [filterCategory, setFilterCategory] = useState<'all' | 'main' | 'side' | 'soup'>('all');\n\n  const [startDate, setStartDate] = useState(() => {\n    const today = new Date();\n    return isTuesday(today) ? today : previousTuesday(today);\n  });\n\n  const sensors = useSensors(\n    useSensor(MouseSensor, { activationConstraint: { distance: 10 } }),\n    useSensor(TouchSensor, { activationConstraint: { delay: 250, tolerance: 5 } })\n  );\n\n  const fetchRecipes = async () => {\n    if (!supabase) {\n      setLoading(false);\n      return;\n    }\n    const { data, error } = await supabase\n      .from('recipes')\n      .select('*')\n      .order('created_at', { ascending: false });\n\n    if (!error) setRecipes(data || []);\n    setLoading(false);\n  };\n\n  const fetchWeeklyPlan = async () => {\n    if (!supabase) return;\n    const endDate = addDays(startDate, 6);\n\n    // Fetch Plans\n    const { data: plansData, error: plansError } = await supabase\n      .from('weekly_plan')\n      .select(`\n            id, date, slot_type, day_type, created_at,\n            recipe:recipes (id, name)\n        `)\n      .gte('date', format(startDate, 'yyyy-MM-dd'))\n      .lte('date', format(endDate, 'yyyy-MM-dd'))\n      .order('created_at', { ascending: true });\n\n    if (!plansError) setPlans((plansData as unknown) as WeeklyPlanItem[]);\n\n    // Fetch Day Settings\n    const { data: settingsData, error: settingsError } = await supabase\n      .from('day_settings')\n      .select('*')\n      .gte('date', format(startDate, 'yyyy-MM-dd'))\n      .lte('date', format(endDate, 'yyyy-MM-dd'));\n\n    if (!settingsError) setDaySettings(settingsData as DaySetting[] || []);\n  };\n\n  useEffect(() => {\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    fetchRecipes();\n  }, []);\n\n  useEffect(() => {\n    fetchWeeklyPlan();\n  }, [startDate]);\n\n  const handleDeletePlan = async (id: string) => {\n    if (!supabase) return;\n    const { error } = await supabase.from('weekly_plan').delete().eq('id', id);\n    if (!error) fetchWeeklyPlan();\n  };\n\n  const handleDragStart = (event: DragStartEvent) => {\n    const { active } = event;\n    setActiveId(String(active.id));\n    const idStr = String(active.id);\n    if (idStr.startsWith('recipe-')) {\n      const rId = idStr.replace('recipe-', '');\n      const r = recipes.find(r => r.id === rId);\n      if (r) setActiveRecipe(r);\n    } else if (idStr.startsWith('plan-')) {\n      const pId = idStr.replace('plan-', '');\n      const plan = plans.find(p => p.id === pId);\n      if (plan) setActiveRecipe({ ...plan.recipe, url: '', frequency: 'monthly', child_rating: 3, memo: '' } as Recipe);\n    }\n  };\n\n  const handleDragEnd = async (event: DragEndEvent) => {\n    const { active, over } = event;\n    setActiveId(null);\n    setActiveRecipe(null);\n\n    if (!over) return;\n    if (!supabase) return;\n\n    const activeIdStr = String(active.id);\n    const overIdStr = String(over.id);\n\n    // Identify Drop Target\n    const isSidebarDrop = overIdStr === 'sidebar-bookshelf';\n    const isSlotDrop = overIdStr.includes('-') && !isSidebarDrop;\n\n    // Helper: Find existing item in target slot to overwrite\n    const findVictim = (dateStr: string, slotType: string, index: number) => {\n      const candidates = plans.filter(p => p.date === dateStr && p.slot_type === slotType);\n      return candidates[index];\n    };\n\n    const currentDayType = daySettings.find(s => s.date === overIdStr.substring(0, 10))?.day_type || 'work';\n\n    // Case 1: Sidebar -> Board Slot (Create/Overwrite)\n    if (activeIdStr.startsWith('recipe-') && isSlotDrop) {\n      const recipeId = activeIdStr.replace('recipe-', '');\n      const dateStr = overIdStr.substring(0, 10);\n      const remainder = overIdStr.substring(11);\n\n      let slotType = remainder;\n      let targetIndex = 0;\n      if (remainder.startsWith('side')) {\n        slotType = 'side';\n        if (remainder === 'side-2') targetIndex = 1;\n      }\n      if (remainder.startsWith('main')) slotType = 'main';\n      if (remainder.startsWith('soup')) slotType = 'soup';\n\n      const victim = findVictim(dateStr, slotType, targetIndex);\n\n      if (victim) {\n        // Overwrite existing\n        const { error } = await supabase\n          .from('weekly_plan')\n          .update({ recipe_id: recipeId })\n          .eq('id', victim.id);\n        if (!error) fetchWeeklyPlan();\n      } else {\n        // Create new\n        const { error } = await supabase\n          .from('weekly_plan')\n          .insert({\n            date: dateStr,\n            recipe_id: recipeId,\n            slot_type: slotType,\n            day_type: currentDayType // Use current setting\n          });\n        if (!error) fetchWeeklyPlan();\n      }\n    }\n\n    // Case 2: Board Slot -> Sidebar (Delete)\n    if (activeIdStr.startsWith('plan-') && isSidebarDrop) {\n      const planId = activeIdStr.replace('plan-', '');\n      const { error } = await supabase\n        .from('weekly_plan')\n        .delete()\n        .eq('id', planId);\n\n      if (!error) fetchWeeklyPlan();\n    }\n\n    // Case 3: Board Slot -> Board Slot (Move/Overwrite)\n    if (activeIdStr.startsWith('plan-') && isSlotDrop) {\n      const planId = activeIdStr.replace('plan-', '');\n      const dateStr = overIdStr.substring(0, 10);\n      const remainder = overIdStr.substring(11);\n\n      let slotType = remainder;\n      let targetIndex = 0;\n      if (remainder.startsWith('side')) {\n        slotType = 'side';\n        if (remainder === 'side-2') targetIndex = 1;\n      }\n      if (remainder.startsWith('main')) slotType = 'main';\n      if (remainder.startsWith('soup')) slotType = 'soup';\n\n      const victim = findVictim(dateStr, slotType, targetIndex);\n\n      // Don't overwrite self\n      if (victim && victim.id === planId) return;\n\n      if (victim) {\n        // Delete victim\n        await supabase.from('weekly_plan').delete().eq('id', victim.id);\n      }\n\n      const { error } = await supabase\n        .from('weekly_plan')\n        .update({\n          date: dateStr,\n          slot_type: slotType\n        })\n        .eq('id', planId);\n\n      if (!error) fetchWeeklyPlan();\n    }\n  };\n\n  const handleImportRecipe = (input: string | Partial<Recipe>) => {\n    if (typeof input === 'string') {\n      setRecipeFormInitialUrl(input);\n      setRecipeFormInitialData(undefined);\n    } else {\n      setRecipeFormInitialUrl('');\n      setRecipeFormInitialData({\n        name: input.name,\n        category: input.category as 'main' | 'side' | 'soup',\n        ingredients: input.ingredients,\n        memo: input.memo\n      });\n    }\n    setActiveTab('my_recipes');\n    setIsRecipeFormOpen(true);\n  };\n\n  const handleAddRecipeFromPatrolUrl = (url: string) => handleImportRecipe(url);\n  const handleAddRecipeFromFlyerData = (recipe: Partial<Recipe>) => handleImportRecipe(recipe);\n\n  const handleToggleDayType = async (date: Date, currentType: 'work' | 'home') => {\n    if (!supabase) return;\n    const dateStr = format(date, 'yyyy-MM-dd');\n    const newType = currentType === 'work' ? 'home' : 'work';\n\n    // Upsert to day_settings\n    const { error } = await supabase\n      .from('day_settings')\n      .upsert({ date: dateStr, day_type: newType }, { onConflict: 'date' });\n\n    if (!error) {\n      // Also update existing plans for visual consistency (though they should rely on Settings now, legacy field might still exist)\n      // In this new model, weekly_plan.day_type is redundant but kept for now.\n      await supabase\n        .from('weekly_plan')\n        .update({ day_type: newType })\n        .eq('date', dateStr);\n\n      fetchWeeklyPlan();\n    }\n  };\n\n  const handleSoupGacha = (date: Date) => {\n    // Check if we have soup recipes\n    const soups = recipes.filter(r => r.category === 'soup');\n    if (soups.length === 0) {\n      alert('ã‚¹ãƒ¼ãƒ—ã®ãƒ¬ã‚·ãƒ”ãŒã¾ã ç™»éŒ²ã•ã‚Œã¦ã„ã¾ã›ã‚“ï¼');\n      return;\n    }\n    setGachaTargetDate(date);\n  };\n\n  const handleGachaConfirm = async (recipe: Recipe) => {\n    if (!supabase || !gachaTargetDate) return;\n\n    const dateStr = format(gachaTargetDate, 'yyyy-MM-dd');\n    const currentDayType = daySettings.find(s => s.date === dateStr)?.day_type || 'work';\n\n    // Insert into plan\n    const { error } = await supabase\n      .from('weekly_plan')\n      .insert({\n        date: dateStr,\n        recipe_id: recipe.id,\n        slot_type: 'soup',\n        day_type: currentDayType\n      });\n\n    if (!error) {\n      fetchWeeklyPlan();\n      setGachaTargetDate(null); // Close modal\n    } else {\n      console.error('Gacha failed:', error);\n      alert('ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ');\n    }\n  };\n\n  // Mobile State\n  const [activeMobileTab, setActiveMobileTab] = useState<'board' | 'shelf'>('board');\n\n  const filteredRecipes = recipes.filter(recipe => {\n    if (filterCategory === 'all') return true;\n    return recipe.category === filterCategory;\n  });\n\n  return (\n    <DndContext sensors={sensors} onDragStart={handleDragStart} onDragEnd={handleDragEnd}>\n      <div className=\"flex h-screen bg-paper text-ink font-hand overflow-hidden flex-col md:flex-row\">\n        {/* Sidebar: Recipe Bookshelf (Hidden on mobile by default, shown if activeMobileTab is 'shelf') */}\n        <aside className={`\n            fixed inset-0 z-40 bg-white/95 backdrop-blur-sm flex flex-col transition-opacity duration-200\n            md:relative md:w-64 md:flex md:inset-auto md:border-r md:border-gray-200 md:shadow-lg md:opacity-100 md:pointer-events-auto md:bg-white/80\n            ${activeMobileTab === 'shelf' ? (activeId ? 'opacity-0 pointer-events-none' : 'opacity-100') : 'hidden md:flex'}\n        `}>\n          <SidebarDroppable>\n            <div className=\"p-4 border-b border-gray-200 bg-orange-50 flex justify-between items-center\">\n              <h2 className=\"text-xl font-bold text-orange-800\">ãƒ¬ã‚·ãƒ”æœ¬æ£š</h2>\n              {/* Mobile Only Close Button */}\n              <button\n                onClick={() => setActiveMobileTab('board')}\n                className=\"md:hidden p-1 bg-white rounded-full text-gray-500 shadow-sm\"\n              >\n                âœ–\n              </button>\n            </div>\n\n            {/* Tabs Container */}\n            <div className=\"px-4 pb-2 bg-orange-50 pt-2\">\n              <div className=\"flex gap-1 bg-white/50 p-1 rounded-md mb-2\">\n                <button\n                  onClick={() => setActiveTab('my_recipes')}\n                  className={`flex-1 py-1 text-xs rounded-sm transition-colors ${activeTab === 'my_recipes' ? 'bg-orange-100 text-orange-700 font-bold shadow-sm' : 'text-gray-500 hover:bg-gray-100'}`}\n                >\n                  My\n                </button>\n                <button\n                  onClick={() => setActiveTab('coop')}\n                  className={`flex-1 py-1 text-xs rounded-sm transition-colors ${activeTab === 'coop' ? 'bg-green-100 text-green-700 font-bold shadow-sm' : 'text-gray-500 hover:bg-gray-100'}`}\n                >\n                  Co-op\n                </button>\n                <button\n                  onClick={() => setActiveTab('buzz')}\n                  className={`flex-1 py-1 text-xs rounded-sm transition-colors ${activeTab === 'buzz' ? 'bg-purple-100 text-purple-700 font-bold shadow-sm' : 'text-gray-500 hover:bg-gray-100'}`}\n                >\n                  Buzz\n                </button>\n                <button\n                  onClick={() => setActiveTab('shopping')}\n                  className={`flex-1 py-1 text-xs rounded-sm transition-colors ${activeTab === 'shopping' ? 'bg-pink-100 text-pink-700 font-bold shadow-sm' : 'text-gray-500 hover:bg-gray-100'}`}\n                >\n                  ãƒãƒ©ã‚·\n                </button>\n              </div>\n\n              {/* Category Filter Chips (Only for My Recipes) */}\n              {activeTab === 'my_recipes' && (\n                <div className=\"flex gap-1 overflow-x-auto pb-1 scrollbar-hide\">\n                  <button\n                    onClick={() => setFilterCategory('all')}\n                    className={`px-2 py-0.5 text-[10px] rounded-full border whitespace-nowrap transition-colors ${filterCategory === 'all' ? 'bg-gray-700 text-white border-gray-700' : 'bg-white border-gray-200 text-gray-500'}`}\n                  >\n                    ã™ã¹ã¦\n                  </button>\n                  <button\n                    onClick={() => setFilterCategory('main')}\n                    className={`px-2 py-0.5 text-[10px] rounded-full border whitespace-nowrap transition-colors ${filterCategory === 'main' ? 'bg-red-100 text-red-700 border-red-200 font-bold' : 'bg-white border-gray-200 text-gray-500'}`}\n                  >\n                    ä¸»èœ\n                  </button>\n                  <button\n                    onClick={() => setFilterCategory('side')}\n                    className={`px-2 py-0.5 text-[10px] rounded-full border whitespace-nowrap transition-colors ${filterCategory === 'side' ? 'bg-green-100 text-green-700 border-green-200 font-bold' : 'bg-white border-gray-200 text-gray-500'}`}\n                  >\n                    å‰¯èœ\n                  </button>\n                  <button\n                    onClick={() => setFilterCategory('soup')}\n                    className={`px-2 py-0.5 text-[10px] rounded-full border whitespace-nowrap transition-colors ${filterCategory === 'soup' ? 'bg-yellow-100 text-yellow-700 border-yellow-200 font-bold' : 'bg-white border-gray-200 text-gray-500'}`}\n                  >\n                    æ±ç‰©\n                  </button>\n                </div>\n              )}\n            </div>\n\n            <div className=\"flex-1 overflow-y-auto p-4 space-y-2 scrollbar-thin scrollbar-thumb-gray-300 pb-24 md:pb-4\">\n              {!supabase && <p className=\"text-xs text-red-500\">DBæœªæ¥ç¶š</p>}\n\n              {activeTab === 'my_recipes' && (\n                <>\n                  {filteredRecipes.map(recipe => (\n                    <DraggableRecipe\n                      key={recipe.id}\n                      id={`recipe-${recipe.id}`}\n                      name={recipe.name}\n                      category={recipe.category}\n                      onEdit={() => setEditingRecipe(recipe)}\n                    />\n                  ))}\n                  {filteredRecipes.length === 0 && !loading && (\n                    <p className=\"text-center text-gray-400 text-sm mt-10\">\n                      {filterCategory === 'all' ? 'ãƒ¬ã‚·ãƒ”ã‚’è¿½åŠ ã—ã¦ã­' : 'ã“ã®ã‚«ãƒ†ã‚´ãƒªã®ãƒ¬ã‚·ãƒ”ã¯ã‚ã‚Šã¾ã›ã‚“'}\n                    </p>\n                  )}\n                </>\n              )}\n\n              {activeTab === 'coop' && (\n                <div className=\"text-center text-gray-400 text-sm mt-10 p-4 border-2 border-dashed border-gray-200 rounded-md\">\n                  <p className=\"mb-2\">ğŸšš</p>\n                  <p>ã‚³ãƒ¼ãƒ—ãƒ‡ãƒªé€£æºæ©Ÿèƒ½</p>\n                  <p className=\"text-xs mt-1\">è³¼å…¥å±¥æ­´ã‹ã‚‰è‡ªå‹•ã§é£Ÿæãƒªã‚¹ãƒˆãƒ»ãƒ¬ã‚·ãƒ”ã‚’è¡¨ç¤ºäºˆå®š</p>\n                </div>\n              )}\n\n              {activeTab === 'buzz' && (\n                <div className=\"h-full\">\n                  <PatrolView onAddRecipe={handleAddRecipeFromPatrolUrl} />\n                </div>\n              )}\n\n              {activeTab === 'shopping' && (\n                <div className=\"h-full\">\n                  <FlyerAnalysisView\n                    onAddRecipe={handleAddRecipeFromFlyerData}\n                    existingRecipes={recipes}\n                  />\n                </div>\n              )}\n            </div>\n\n            {activeTab === 'my_recipes' && (\n              <div className=\"p-4 bg-gray-50 border-t border-gray-200 pb-24 md:pb-4\">\n                <RecipeForm\n                  onRecipeAdded={fetchRecipes}\n                  isOpen={isRecipeFormOpen}\n                  onOpenChange={setIsRecipeFormOpen}\n                  initialUrl={recipeFormInitialUrl}\n                  initialData={recipeFormInitialData}\n                />\n              </div>\n            )}\n          </SidebarDroppable>\n        </aside>\n\n        {/* Main: Weekly Board (Always visible on mobile now to allow drop, sitting behind sidebar) */}\n        <main className=\"flex-1 flex flex-col relative w-full overflow-hidden\">\n          <div className=\"p-4 flex justify-between items-center bg-white/50 border-b border-gray-200\">\n            <h1 className=\"text-xl md:text-2xl font-bold text-ink\">é€±é–“ãƒ‘ãƒ¬ãƒƒãƒˆ ğŸ¨</h1>\n            <div className=\"flex gap-2\">\n              <button onClick={() => setStartDate(d => addDays(d, -7))} className=\"px-2 py-1 md:px-3 border rounded hover:bg-gray-100 text-xs md:text-sm\">â† å…ˆé€±</button>\n              <button onClick={() => setStartDate(d => addDays(d, 7))} className=\"px-2 py-1 md:px-3 border rounded hover:bg-gray-100 text-xs md:text-sm\">æ¥é€± â†’</button>\n            </div>\n          </div>\n          <WeeklyBoard\n            startDate={startDate}\n            plans={plans}\n            daySettings={daySettings}\n            onToggleDayType={handleToggleDayType}\n            onDeletePlan={handleDeletePlan}\n            onSoupGacha={handleSoupGacha}\n          />\n        </main>\n\n        {/* Mobile Bottom Navigation */}\n        <div className=\"md:hidden fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 flex justify-around p-2 z-50 safe-area-bottom shadow-[0_-2px_10px_rgba(0,0,0,0.05)]\">\n          <button\n            onClick={() => setActiveMobileTab('board')}\n            className={`flex flex-col items-center p-2 rounded-lg flex-1 ${activeMobileTab === 'board' ? 'text-orange-600 bg-orange-50' : 'text-gray-400'}`}\n          >\n            <span className=\"text-2xl\">ğŸ“…</span>\n            <span className=\"text-[10px] font-bold mt-1\">çŒ®ç«‹ãƒ‘ãƒ¬ãƒƒãƒˆ</span>\n          </button>\n          <button\n            onClick={() => setActiveMobileTab('shelf')}\n            className={`flex flex-col items-center p-2 rounded-lg flex-1 ${activeMobileTab === 'shelf' ? 'text-orange-600 bg-orange-50' : 'text-gray-400'}`}\n          >\n            <span className=\"text-2xl\">ğŸ“š</span>\n            <span className=\"text-[10px] font-bold mt-1\">ãƒ¬ã‚·ãƒ”æœ¬æ£š</span>\n          </button>\n        </div>\n\n      </div>\n\n      <RecipeDetailModal\n        recipe={editingRecipe}\n        isOpen={!!editingRecipe}\n        onClose={() => setEditingRecipe(null)}\n        onUpdate={fetchRecipes}\n      />\n\n      <SoupGachaModal\n        isOpen={!!gachaTargetDate}\n        onClose={() => setGachaTargetDate(null)}\n        onConfirm={handleGachaConfirm}\n        recipes={recipes.filter(r => r.category === 'soup')}\n      />\n\n      <DragOverlay>\n        {activeId && activeRecipe ? (\n          <div className=\"opacity-80 rotate-3 cursor-grabbing pointer-events-none\">\n            <div className=\"bg-white p-3 rounded-sm shadow-xl border-2 border-orange-200 w-64\">\n              <div className=\"flex items-center gap-2\">\n                <div className=\"w-8 h-8 bg-orange-100 rounded-full flex items-center justify-center text-xs font-bold text-orange-600\">\n                  {activeRecipe.name.slice(0, 1)}\n                </div>\n                <span className=\"text-sm font-bold\">{activeRecipe.name}</span>\n              </div>\n            </div>\n          </div>\n        ) : null}\n      </DragOverlay>\n    </DndContext>\n  );\n}\n\nexport default App;\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tomoh\\clawd\\vibe-cooking\\src\\components\\DayColumn.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tomoh\\clawd\\vibe-cooking\\src\\components\\DraggableRecipe.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tomoh\\clawd\\vibe-cooking\\src\\components\\FlyerAnalysisView.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tomoh\\clawd\\vibe-cooking\\src\\components\\PatrolView.tsx","messages":[],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchPatrolRecipes'. Either include it or remove the dependency array.","line":87,"column":8,"nodeType":"ArrayExpression","endLine":87,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [fetchPatrolRecipes]","fix":{"range":[3136,3138],"text":"[fetchPatrolRecipes]"}}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tomoh\\clawd\\vibe-cooking\\src\\components\\RecipeCard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tomoh\\clawd\\vibe-cooking\\src\\components\\RecipeDetailModal.tsx","messages":[{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported).","line":27,"column":5,"severity":1,"nodeType":null,"fix":{"range":[1117,1144],"text":" "}},{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\nC:\\Users\\tomoh\\clawd\\vibe-cooking\\src\\components\\RecipeDetailModal.tsx:30:13\n  28 |     useEffect(() => {\n  29 |         if (recipe) {\n> 30 |             setName(recipe.name);\n     |             ^^^^^^^ Avoid calling setState() directly within an effect\n  31 |             setUrl(recipe.url || '');\n  32 |             setCategory(recipe.category || 'main');\n  33 |             setMemo(recipe.memo || '');","line":30,"column":13,"nodeType":null,"endLine":30,"endColumn":20}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":1,"source":"import { useState, useEffect } from 'react';\r\nimport { createPortal } from 'react-dom';\r\nimport { motion, AnimatePresence } from 'framer-motion';\r\nimport { X, Save } from 'lucide-react';\r\nimport type { Recipe } from '../types';\r\nimport { supabase } from '../lib/supabase';\r\n\r\ninterface RecipeDetailModalProps {\r\n    recipe: Recipe | null;\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    onUpdate: () => void;\r\n}\r\n\r\nexport const RecipeDetailModal = ({ recipe, isOpen, onClose, onUpdate }: RecipeDetailModalProps) => {\r\n    const [name, setName] = useState('');\r\n    const [url, setUrl] = useState('');\r\n    const [category, setCategory] = useState<'main' | 'side' | 'soup'>('main');\r\n    const [memo, setMemo] = useState('');\r\n    const [rating, setRating] = useState(3);\r\n    const [frequency, setFrequency] = useState<'biweekly' | 'monthly' | 'quarterly' | 'none'>('none');\r\n    const [workDuration, setWorkDuration] = useState(0);\r\n    const [ingredients, setIngredients] = useState('');\r\n    const [newArrangement, setNewArrangement] = useState('');\r\n    const [loading, setLoading] = useState(false);\r\n\r\n    // eslint-disable-next-line\r\n    useEffect(() => {\r\n        if (recipe) {\r\n            setName(recipe.name);\r\n            setUrl(recipe.url || '');\r\n            setCategory(recipe.category || 'main');\r\n            setMemo(recipe.memo || '');\r\n            setRating(recipe.child_rating || 3);\r\n            setFrequency(recipe.frequency || 'none');\r\n            setWorkDuration(recipe.work_duration || 0);\r\n            setIngredients(recipe.ingredients ? recipe.ingredients.join('\\n') : '');\r\n        }\r\n    }, [recipe]);\r\n\r\n    const handleSubmit = async (e: React.FormEvent) => {\r\n        e.preventDefault();\r\n        if (!supabase || !recipe) return;\r\n\r\n        setLoading(true);\r\n\r\n        const updatedArrangements = recipe.arrangements || [];\r\n        if (newArrangement.trim()) {\r\n            updatedArrangements.push({\r\n                date: new Date().toISOString().split('T')[0],\r\n                text: newArrangement.trim()\r\n            });\r\n        }\r\n\r\n        const { error } = await supabase\r\n            .from('recipes')\r\n            .update({\r\n                name,\r\n                url,\r\n                category,\r\n                memo,\r\n                child_rating: rating,\r\n                frequency,\r\n                work_duration: workDuration,\r\n                ingredients: ingredients.split('\\n').filter(line => line.trim() !== ''),\r\n                arrangements: updatedArrangements,\r\n            })\r\n            .eq('id', recipe.id);\r\n\r\n        setLoading(false);\r\n\r\n        if (error) {\r\n            alert('ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ: ' + error.message);\r\n        } else {\r\n            onUpdate();\r\n            onClose();\r\n            setNewArrangement(''); // Reset input\r\n        }\r\n    };\r\n\r\n    if (!isOpen || !recipe) return null;\r\n\r\n    return createPortal(\r\n        <AnimatePresence>\r\n            <div className=\"fixed inset-0 z-50 flex items-center justify-center p-4\">\r\n                <motion.div\r\n                    initial={{ opacity: 0 }}\r\n                    animate={{ opacity: 1 }}\r\n                    exit={{ opacity: 0 }}\r\n                    onClick={onClose}\r\n                    className=\"absolute inset-0 bg-black/40 backdrop-blur-sm\"\r\n                />\r\n                <motion.div\r\n                    initial={{ opacity: 0, scale: 0.9, y: 20 }}\r\n                    animate={{ opacity: 1, scale: 1, y: 0 }}\r\n                    exit={{ opacity: 0, scale: 0.9, y: 20 }}\r\n                    className=\"relative bg-white rounded-lg shadow-xl w-full max-w-md overflow-hidden font-hand border-2 border-orange-100\"\r\n                    style={{\r\n                        backgroundImage: 'radial-gradient(#f3f4f6 1px, transparent 1px)',\r\n                        backgroundSize: '24px 24px'\r\n                    }}\r\n                >\r\n                    {/* Header */}\r\n                    <div className=\"flex justify-between items-center p-4 border-b border-gray-100 bg-white/80\">\r\n                        <h3 className=\"text-xl font-bold text-orange-800\">ãƒ¬ã‚·ãƒ”ã‚’ç·¨é›†</h3>\r\n                        <button onClick={onClose} className=\"p-1 hover:bg-gray-100 rounded-full transition-colors\">\r\n                            <X size={24} className=\"text-gray-400\" />\r\n                        </button>\r\n                    </div>\r\n\r\n                    {/* Form */}\r\n                    <form onSubmit={handleSubmit} className=\"p-6 space-y-4 max-h-[80vh] overflow-y-auto\">\r\n                        {/* Name */}\r\n                        <div>\r\n                            <label className=\"block text-sm font-bold text-gray-600 mb-1\">æ–™ç†å</label>\r\n                            <input\r\n                                type=\"text\"\r\n                                value={name}\r\n                                onChange={(e) => setName(e.target.value)}\r\n                                className=\"w-full p-2 bg-white border border-gray-200 rounded focus:border-orange-400 focus:ring-1 focus:ring-orange-200 outline-none transition-all\"\r\n                                required\r\n                            />\r\n                        </div>\r\n\r\n                        {/* Category */}\r\n                        <div>\r\n                            <label className=\"block text-sm font-bold text-gray-600 mb-1\">ã‚«ãƒ†ã‚´ãƒªãƒ¼</label>\r\n                            <div className=\"flex gap-2\">\r\n                                {[\r\n                                    { id: 'main', label: 'ä¸»èœ', color: 'bg-red-100 text-red-700 border-red-200' },\r\n                                    { id: 'side', label: 'å‰¯èœ', color: 'bg-green-100 text-green-700 border-green-200' },\r\n                                    { id: 'soup', label: 'æ±ç‰©', color: 'bg-yellow-100 text-yellow-700 border-yellow-200' }\r\n                                ].map((cat) => (\r\n                                    <button\r\n                                        key={cat.id}\r\n                                        type=\"button\"\r\n                                        onClick={() => setCategory(cat.id as 'main' | 'side' | 'soup')}\r\n                                        className={`flex-1 py-2 rounded-md border-2 text-sm font-bold transition-all ${category === cat.id\r\n                                            ? `${cat.color} shadow-sm`\r\n                                            : 'bg-gray-50 border-gray-100 text-gray-400'\r\n                                            }`}\r\n                                    >\r\n                                        {cat.label}\r\n                                    </button>\r\n                                ))}\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Rating & Frequency */}\r\n                        <div className=\"flex gap-4\">\r\n                            <div className=\"flex-1\">\r\n                                <label className=\"block text-sm font-bold text-gray-600 mb-1\">ãŠæ°—ã«å…¥ã‚Šåº¦</label>\r\n                                <div className=\"flex gap-1\">\r\n                                    {[1, 2, 3].map((star) => (\r\n                                        <button\r\n                                            key={star}\r\n                                            type=\"button\"\r\n                                            onClick={() => setRating(star)}\r\n                                            className={`text-2xl transition-transform hover:scale-110 ${rating >= star ? 'text-yellow-400' : 'text-gray-200'\r\n                                                }`}\r\n                                        >\r\n                                            â˜…\r\n                                        </button>\r\n                                    ))}\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"flex-1\">\r\n                                <label className=\"block text-sm font-bold text-gray-600 mb-1\">èª¿ç†æ™‚é–“ (åˆ†)</label>\r\n                                <input\r\n                                    type=\"number\"\r\n                                    value={workDuration}\r\n                                    onChange={(e) => setWorkDuration(Number(e.target.value))}\r\n                                    placeholder=\"15\"\r\n                                    className=\"w-full p-2 bg-white border border-gray-200 rounded focus:border-orange-400 outline-none\"\r\n                                />\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"flex gap-4\">\r\n                            <div className=\"flex-1\">\r\n                                <label className=\"block text-sm font-bold text-gray-600 mb-1\">é »åº¦</label>\r\n                                <select\r\n                                    value={frequency}\r\n                                    onChange={(e) => setFrequency(e.target.value as 'biweekly' | 'monthly' | 'quarterly' | 'none')}\r\n                                    className=\"w-full p-2 bg-white border border-gray-200 rounded focus:border-orange-400 outline-none\"\r\n                                >\r\n                                    <option value=\"biweekly\">éš”é€±</option>\r\n                                    <option value=\"monthly\">æœˆ1å›</option>\r\n                                    <option value=\"quarterly\">2-3ã‹æœˆã«1å›</option>\r\n                                    <option value=\"none\">è¨­å®šãªã—</option>\r\n                                </select>\r\n                            </div>\r\n                        </div>\r\n\r\n                        {/* Memo */}\r\n                        <div>\r\n                            <label className=\"block text-sm font-bold text-gray-600 mb-1\">è‡ªåˆ†æµãƒ¡ãƒ¢</label>\r\n                            <textarea\r\n                                value={memo}\r\n                                onChange={(e) => setMemo(e.target.value)}\r\n                                rows={3}\r\n                                placeholder=\"ä¾‹ï¼šã«ã‚“ã˜ã‚“ã‚’å…¥ã‚Œã‚‹ã¨ç¾å‘³ã—ã„ / å‘³ãŒè–„ã„ã®ã§é†¤æ²¹å¤šã‚\"\r\n                                className=\"w-full p-2 bg-yellow-50/50 border border-yellow-200 rounded focus:border-orange-400 outline-none text-sm leading-relaxed resize-none\"\r\n                            />\r\n                        </div>\r\n\r\n                        {/* Arrangements (History) */}\r\n                        <div>\r\n                            <label className=\"block text-sm font-bold text-gray-600 mb-1\">ã‚¢ãƒ¬ãƒ³ã‚¸å±¥æ­´</label>\r\n\r\n                            {/* Existing Arrangements */}\r\n                            {recipe.arrangements && recipe.arrangements.length > 0 && (\r\n                                <div className=\"mb-2 space-y-2\">\r\n                                    {recipe.arrangements.map((item, index) => (\r\n                                        <div key={index} className=\"bg-yellow-50/50 p-2 rounded border border-yellow-100 text-sm\">\r\n                                            <div className=\"text-xs text-gray-400 mb-1\">{item.date}</div>\r\n                                            <div className=\"text-gray-700 whitespace-pre-wrap\">{item.text}</div>\r\n                                        </div>\r\n                                    ))}\r\n                                </div>\r\n                            )}\r\n\r\n                            {/* New Arrangement Input */}\r\n                            <textarea\r\n                                value={newArrangement}\r\n                                onChange={(e) => setNewArrangement(e.target.value)}\r\n                                rows={2}\r\n                                placeholder=\"ä»Šå›ã®ã‚¢ãƒ¬ãƒ³ã‚¸ï¼šã—ã„ãŸã‘ã‚’ã‚¨ãƒªãƒ³ã‚®ã«å¤‰æ›´...\"\r\n                                className=\"w-full p-2 bg-white border border-gray-200 rounded focus:border-orange-400 outline-none text-sm transition-colors\"\r\n                            />\r\n                        </div>\r\n\r\n                        {/* URL */}\r\n                        <div>\r\n                            <label className=\"block text-sm font-bold text-gray-600 mb-1\">å‚è€ƒURL</label>\r\n                            <input\r\n                                type=\"url\"\r\n                                value={url}\r\n                                onChange={(e) => setUrl(e.target.value)}\r\n                                placeholder=\"https://...\"\r\n                                className=\"w-full p-2 bg-white border border-gray-200 rounded text-sm text-gray-500 focus:text-ink focus:border-orange-400 outline-none\"\r\n                            />\r\n                        </div>\r\n\r\n                        {/* Ingredients & Steps Display */}\r\n                        {/* Ingredients Input */}\r\n                        <div className=\"mt-4 pt-4 border-t border-gray-100\">\r\n                            <label className=\"block text-sm font-bold text-gray-600 mb-1\">ææ–™ <span className=\"text-xs font-normal text-gray-400\">(1è¡Œãšã¤)</span></label>\r\n                            <textarea\r\n                                value={ingredients}\r\n                                onChange={(e) => setIngredients(e.target.value)}\r\n                                rows={6}\r\n                                placeholder=\"è±šè‚‰ 200g&#13;&#10;ç‰ã­ã 1å€‹\"\r\n                                className=\"w-full p-2 bg-white border border-gray-200 rounded focus:border-orange-400 outline-none text-sm leading-relaxed\"\r\n                            />\r\n                        </div>\r\n\r\n                        {/* Actions */}\r\n                        <div className=\"pt-4 flex gap-3\">\r\n                            <button\r\n                                type=\"button\"\r\n                                onClick={onClose}\r\n                                className=\"flex-1 py-3 text-gray-500 font-bold hover:bg-gray-100 rounded-md transition-colors\"\r\n                            >\r\n                                ã‚­ãƒ£ãƒ³ã‚»ãƒ«\r\n                            </button>\r\n                            <button\r\n                                type=\"submit\"\r\n                                disabled={loading}\r\n                                className=\"flex-1 py-3 bg-orange-500 text-white font-bold rounded-md shadow-md hover:bg-orange-600 transition-colors disabled:opacity-50 flex items-center justify-center gap-2\"\r\n                            >\r\n                                <Save size={18} />\r\n                                {loading ? 'ä¿å­˜ä¸­...' : 'ä¿å­˜ã™ã‚‹'}\r\n                            </button>\r\n                        </div>\r\n                    </form>\r\n                </motion.div>\r\n            </div>\r\n        </AnimatePresence >,\r\n        document.body\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tomoh\\clawd\\vibe-cooking\\src\\components\\RecipeForm.tsx","messages":[],"suppressedMessages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'handleUrlBlur'. Either include it or remove the dependency array.","line":50,"column":8,"nodeType":"ArrayExpression","endLine":50,"endColumn":46,"suggestions":[{"desc":"Update the dependencies array to be: [url, isOpen, initialUrl, initialData, handleUrlBlur]","fix":{"range":[1989,2027],"text":"[url, isOpen, initialUrl, initialData, handleUrlBlur]"}}],"suppressions":[{"kind":"directive","justification":""}]}],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tomoh\\clawd\\vibe-cooking\\src\\components\\SoupGachaModal.tsx","messages":[{"ruleId":null,"message":"Unused eslint-disable directive (no problems were reported from 'react-hooks/exhaustive-deps').","line":26,"column":9,"severity":1,"nodeType":null,"fix":{"range":[968,1023],"text":" "}}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":1,"source":"import { useState, useEffect } from 'react';\r\nimport { Dices, Sparkles, RefreshCw, Check } from 'lucide-react';\r\nimport type { Recipe } from '../types';\r\n\r\ninterface SoupGachaModalProps {\r\n    isOpen: boolean;\r\n    onClose: () => void;\r\n    onConfirm: (recipe: Recipe) => void;\r\n    recipes: Recipe[];\r\n}\r\n\r\nexport const SoupGachaModal = ({ isOpen, onClose, onConfirm, recipes }: SoupGachaModalProps) => {\r\n    const [step, setStep] = useState<'ready' | 'spinning' | 'result'>('ready');\r\n    const [displayRecipe, setDisplayRecipe] = useState<Recipe | null>(null);\r\n    const [resultRecipe, setResultRecipe] = useState<Recipe | null>(null);\r\n    const [isMisoMode, setIsMisoMode] = useState(false);\r\n    const [activePool, setActivePool] = useState<Recipe[]>([]);\r\n\r\n    // Reset state when opening\r\n    useEffect(() => {\r\n        if (isOpen) {\r\n            setStep('ready');\r\n            setDisplayRecipe(null);\r\n            setIsMisoMode(false);\r\n        }\r\n        // eslint-disable-next-line react-hooks/exhaustive-deps\r\n    }, [isOpen]);\r\n\r\n    const handleStartGacha = () => {\r\n        let candidates = recipes;\r\n        if (isMisoMode) {\r\n            candidates = recipes.filter(r =>\r\n                r.name.includes('å‘³å™Œ') ||\r\n                r.name.includes('ã¿ã') ||\r\n                r.name.includes('è±šæ±')\r\n            );\r\n        }\r\n\r\n        if (candidates.length === 0) {\r\n            alert(isMisoMode\r\n                ? 'ã€Œå‘³å™Œã€ã‚„ã€Œè±šæ±ã€ã®ãƒ¬ã‚·ãƒ”ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ï¼\\nã¾ãšã¯ãƒ¬ã‚·ãƒ”ã‚’è¿½åŠ ã—ã¦ãã ã•ã„ã€‚'\r\n                : 'ã‚¹ãƒ¼ãƒ—ã®ãƒ¬ã‚·ãƒ”ãŒã‚ã‚Šã¾ã›ã‚“ï¼'\r\n            );\r\n            return;\r\n        }\r\n\r\n        setActivePool(candidates);\r\n        setStep('spinning');\r\n    };\r\n\r\n    // Spinning Logic\r\n    useEffect(() => {\r\n        if (step === 'spinning' && activePool.length > 0) {\r\n            const interval = setInterval(() => {\r\n                const random = activePool[Math.floor(Math.random() * activePool.length)];\r\n                setDisplayRecipe(random);\r\n            }, 100);\r\n\r\n            const timeout = setTimeout(() => {\r\n                clearInterval(interval);\r\n                // Final pick\r\n                const final = activePool[Math.floor(Math.random() * activePool.length)];\r\n                setResultRecipe(final);\r\n                setDisplayRecipe(final);\r\n                setStep('result');\r\n            }, 2000); // multiple seconds of suspense\r\n\r\n            return () => {\r\n                clearInterval(interval);\r\n                clearTimeout(timeout);\r\n            };\r\n        }\r\n    }, [step, activePool]);\r\n\r\n    if (!isOpen) return null;\r\n\r\n    return (\r\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50 backdrop-blur-sm p-4\">\r\n            <div className=\"bg-white rounded-xl shadow-2xl w-full max-w-sm overflow-hidden relative border-4 border-orange-200\">\r\n                {/* Close Button */}\r\n                <button\r\n                    onClick={onClose}\r\n                    className=\"absolute top-2 right-2 p-2 text-gray-400 hover:text-gray-600 z-10\"\r\n                >\r\n                    âœ–\r\n                </button>\r\n\r\n                <div className=\"p-8 flex flex-col items-center text-center\">\r\n\r\n                    {/* Header Image / Icon */}\r\n                    <div className=\"mb-6 relative\">\r\n                        <div className={`\r\n                            w-24 h-24 rounded-full flex items-center justify-center text-white text-4xl shadow-lg\r\n                            ${step === 'ready' ? (isMisoMode ? 'bg-amber-600' : 'bg-orange-400') : ''}\r\n                            ${step === 'spinning' ? 'bg-orange-500 animate-spin' : ''}\r\n                            ${step === 'result' ? 'bg-yellow-400 animate-bounce' : ''}\r\n                        `}>\r\n                            {step === 'ready' && <Dices size={48} />}\r\n                            {step === 'spinning' && <Dices size={48} />}\r\n                            {step === 'result' && <Sparkles size={48} />}\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Content based on Step */}\r\n                    {step === 'ready' && (\r\n                        <>\r\n                            <h2 className=\"text-2xl font-bold text-orange-800 mb-2 font-hand\">\r\n                                {isMisoMode ? 'å‘³å™Œæ±ãƒ¢ãƒ¼ãƒ‰ONï¼' : 'ä»Šæ—¥ã¯ã©ã®ã‚¹ãƒ¼ãƒ—ï¼Ÿ'}\r\n                            </h2>\r\n                            <p className=\"text-gray-500 mb-6\">\r\n                                {isMisoMode ? 'æ¸©ã‹ã„ãŠå‘³å™Œæ±ã¯ã„ã‹ãŒï¼Ÿ' : 'ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦ã‚¬ãƒãƒ£ã‚’å›ãã†ï¼'}\r\n                            </p>\r\n\r\n                            {/* Miso Mode Toggle */}\r\n                            <div className=\"mb-6 flex items-center justify-center gap-2 bg-orange-50 p-2 rounded-lg cursor-pointer\" onClick={() => setIsMisoMode(!isMisoMode)}>\r\n                                <div className={`w-10 h-6 rounded-full p-1 transition-colors duration-300 ${isMisoMode ? 'bg-amber-600' : 'bg-gray-300'}`}>\r\n                                    <div className={`bg-white w-4 h-4 rounded-full shadow-md transform transition-transform duration-300 ${isMisoMode ? 'translate-x-4' : ''}`}></div>\r\n                                </div>\r\n                                <span className={`text-sm font-bold ${isMisoMode ? 'text-amber-800' : 'text-gray-500'}`}>\r\n                                    å‘³å™Œæ±ãƒ¢ãƒ¼ãƒ‰ï¼ˆã¿ããƒ»è±šæ±é™å®šï¼‰\r\n                                </span>\r\n                            </div>\r\n\r\n                            <button\r\n                                onClick={handleStartGacha}\r\n                                className={`w-full text-white font-bold py-4 px-6 rounded-full shadow-lg transform transition active:scale-95 text-xl flex items-center justify-center gap-2\r\n                                    ${isMisoMode ? 'bg-amber-600 hover:bg-amber-700' : 'bg-orange-500 hover:bg-orange-600'}\r\n                                `}\r\n                            >\r\n                                <Dices /> ã‚¬ãƒãƒ£ã‚’å›ã™\r\n                            </button>\r\n                        </>\r\n                    )}\r\n\r\n                    {step === 'spinning' && (\r\n                        <>\r\n                            <h2 className=\"text-2xl font-bold text-orange-600 mb-2 font-hand animate-pulse\">\r\n                                æŠ½é¸ä¸­...\r\n                            </h2>\r\n                            <div className=\"h-16 flex items-center justify-center\">\r\n                                <span className=\"text-xl font-bold text-gray-700\">\r\n                                    {displayRecipe?.name || \"...\"}\r\n                                </span>\r\n                            </div>\r\n                        </>\r\n                    )}\r\n\r\n                    {step === 'result' && resultRecipe && (\r\n                        <>\r\n                            <p className=\"text-orange-500 font-bold mb-1\">æ±ºå®šï¼ä»Šæ—¥ã®ã‚¹ãƒ¼ãƒ—ã¯...</p>\r\n                            <h2 className=\"text-3xl font-bold text-ink mb-6 font-hand leading-tight\">\r\n                                {resultRecipe.name}\r\n                            </h2>\r\n\r\n                            <div className=\"flex flex-col gap-3 w-full\">\r\n                                <button\r\n                                    onClick={() => onConfirm(resultRecipe)}\r\n                                    className=\"w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-xl shadow-md transform transition active:scale-95 flex items-center justify-center gap-2\"\r\n                                >\r\n                                    <Check /> ã“ã‚Œã«ã™ã‚‹ï¼\r\n                                </button>\r\n                                <button\r\n                                    onClick={() => setStep('ready')}\r\n                                    className=\"w-full bg-gray-100 hover:bg-gray-200 text-gray-600 font-bold py-3 px-6 rounded-xl transition flex items-center justify-center gap-2\"\r\n                                >\r\n                                    <RefreshCw size={18} /> ã‚‚ã†ä¸€å›\r\n                                </button>\r\n                            </div>\r\n                        </>\r\n                    )}\r\n\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tomoh\\clawd\\vibe-cooking\\src\\components\\WeeklyBoard.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tomoh\\clawd\\vibe-cooking\\src\\lib\\supabase.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tomoh\\clawd\\vibe-cooking\\src\\main.tsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tomoh\\clawd\\vibe-cooking\\src\\types.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\tomoh\\clawd\\vibe-cooking\\vite.config.ts","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]